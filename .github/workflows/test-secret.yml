name: Testar Secret GOOGLE_API_KEY

on:
  workflow_dispatch:
  push:
    branches: [ main ]

jobs:
  test-secret:
    name: Verificar API Key Secret
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout cÃ³digo
      uses: actions/checkout@v4
      
    - name: Verificar se secret existe
      run: |
        echo "ğŸ” Verificando se GOOGLE_API_KEY estÃ¡ configurado..."
        if [ -z "$GOOGLE_API_KEY" ]; then
          echo "âŒ GOOGLE_API_KEY nÃ£o estÃ¡ definido"
          exit 1
        else
          echo "âœ… GOOGLE_API_KEY estÃ¡ definido!"
          echo "ğŸ“ Tamanho da chave: ${#GOOGLE_API_KEY} caracteres"
          echo "ğŸ”‘ Primeiros 4 caracteres: ${GOOGLE_API_KEY:0:4}..."
          echo "ğŸ”‘ Ãšltimos 4 caracteres: ...${GOOGLE_API_KEY: -4}"
        fi
      env:
        GOOGLE_API_KEY: ${{ secrets.GOOGLE_API_KEY }}
        
    - name: Testar formato da API key
      run: |
        echo "ğŸ” Testando formato da API key..."
        if echo "$GOOGLE_API_KEY" | grep -q "^AIza"; then
          echo "âœ… Formato correto! ComeÃ§a com 'AIza'"
        else
          echo "âŒ Formato incorreto! Deve comeÃ§ar com 'AIza'"
          echo "ğŸ”‘ Formato atual: ${GOOGLE_API_KEY:0:4}..."
          exit 1
        fi
      env:
        GOOGLE_API_KEY: ${{ secrets.GOOGLE_API_KEY }}
